---
import Navbar from '../layouts/navbar.astro';
import { getCollection } from 'astro:content';

const books = await getCollection('booknotes');
const sortedBooks = books.sort((a, b) => b.data.finished.localeCompare(a.data.finished));
---

<Navbar title="Library | Ink & Insights">
  <div class="animate-layout-entry">
    
    <header class="mb-12 md:mb-24 pt-8">
      <h1 class="mb-6 md:mb-8 font-serif text-4xl sm:text-5xl md:text-7xl tracking-tight text-slate-900 italic">
        Ink & Insights<span class="text-rose-400">.</span>
      </h1>
      <p class="mb-8 md:mb-12 max-w-2xl font-serif text-base md:text-xl leading-relaxed text-slate-400 italic">
        Condensed thoughts and takeaways from my bookshelf.
      </p>

      <div class="flex flex-col sm:flex-row sm:items-center gap-4 sm:gap-6 border-t border-slate-200 pt-8">
        <span class="text-[9px] font-black tracking-[0.3em] text-slate-300 uppercase">Sort by</span>
        <div class="flex flex-wrap gap-4 md:gap-6">
          <button class="border-b border-slate-900 text-[10px] font-bold tracking-widest text-slate-900 uppercase">Newest</button>
          <button class="text-[10px] font-bold tracking-widest text-slate-400 uppercase transition-colors hover:text-slate-900">Rating</button>
          <button class="text-[10px] font-bold tracking-widest text-slate-400 uppercase transition-colors hover:text-slate-900">Title</button>
        </div>
      </div>
    </header>

    <section class="grid grid-cols-1 gap-x-8 gap-y-12 sm:grid-cols-2 lg:grid-cols-3">
      {sortedBooks.map((book) => (
        <div class="group flex h-full w-full flex-col rounded-[2.5rem] bg-white p-6 md:p-8 shadow-[0_10px_40px_-15px_rgba(0,0,0,0.04)] transition-all duration-700 hover:shadow-[0_40px_80px_-20px_rgba(0,0,0,0.12)]">
          
          <div class="mb-6 md:mb-8 flex h-48 md:h-52 items-center justify-center overflow-hidden">
            <img 
              src={book.data.image} 
              class="h-full object-contain drop-shadow-[0_20px_30px_rgba(0,0,0,0.12)] transition-transform duration-700 group-hover:scale-105" 
              alt={book.data.title} 
            />
          </div>

          <div class="flex flex-grow flex-col text-center px-2">
            <h2 class="mb-4 line-clamp-2 font-serif text-xl md:text-[22px] leading-tight font-black text-slate-900">
              {book.data.title}
            </h2>
            <p class="mb-4 text-xs font-medium text-slate-400">by {book.data.author}</p>

            <div class="mt-auto">
              <div class="mb-6 flex items-center justify-between border-t border-slate-100 pt-6">
                <div class="text-left">
                  <span class="block text-[8px] font-black tracking-widest text-slate-300 uppercase">Rating</span>
                  <span class="font-serif text-sm md:text-base leading-none text-slate-900 italic">{book.data.rating}</span>
                </div>
                <div class="text-right">
                  <span class="block text-[8px] font-black tracking-widest text-slate-300 uppercase">Finished</span>
                  <span class="font-serif text-sm md:text-base leading-none text-slate-900 italic">{book.data.finished}</span>
                </div>
              </div>

              <a href={`/library/${book.slug}`} class="inline-flex items-center justify-center gap-2 text-[11px] font-black tracking-widest text-slate-900 uppercase transition-colors group-hover:text-rose-500"> 
                Read Notes <span class="text-lg transition-transform group-hover:translate-x-1">â†’</span> 
              </a>
            </div>
          </div>
        </div>
      ))}
    </section>

    <section class="mt-20 border-t border-slate-200/60 py-16 text-center">
      <div class="mx-auto max-w-md">
        <h2 class="mb-4 font-serif text-3xl italic tracking-tight text-slate-900">Thoughts?</h2>
        <p class="text-[12px] font-medium leading-relaxed text-slate-400">
          Feel free to ping me if any of these notes sparked an idea.
        </p>
      </div>
    </section>

  </div>
</Navbar>
