---
import '../styles/global.css'; // Adjust the path if necessary
import { getCollection } from 'astro:content';

// Fetch all entries from the 'booknotes' collection
const books = await getCollection('booknotes');

// Sort by finished date (newest first)
const sortedBooks = books.sort((a, b) => b.data.finished.localeCompare(a.data.finished));
---

<div class="flex min-h-screen flex-col bg-[#F9F7F4] font-sans text-slate-600 antialiased selection:bg-rose-100">
  <nav class="mx-auto flex w-full max-w-6xl items-center justify-between px-6 py-10 md:px-10 md:py-16">
    <div class="flex items-center gap-2">
      <div class="h-2 w-2 rounded-full bg-rose-400"></div>
      <h1 class="text-xl font-bold tracking-tighter text-slate-900 italic">H.A<span class="text-rose-400">.</span></h1>
    </div>
    <div class="flex space-x-6 text-[10px] font-black tracking-[0.2em] text-slate-400 uppercase md:space-x-10 md:text-[11px]">
      <a href="/articles" class="transition-colors hover:text-slate-900">Articles</a>
      <a href="/projects" class="transition-colors hover:text-slate-900">Projects</a>
      <a href="/library" class="border-b-2 border-rose-400 pb-1 text-slate-900">Library</a>
    </div>
  </nav>

  <main class="mx-auto w-full max-w-6xl flex-grow px-6 pb-32 md:px-10">
    <header class="mb-16 md:mb-24">
      <h1 class="mb-8 font-serif text-5xl tracking-tight text-slate-900 italic md:text-7xl">Ink & Insights<span class="text-rose-400">.</span></h1>
      <p class="mb-12 max-w-2xl font-serif text-lg leading-relaxed text-slate-400 italic md:text-xl">
        Condensed thoughts and takeaways from my bookshelf.
      </p>

      <div class="flex items-center gap-6 border-t border-slate-200 pt-8">
        <span class="text-[9px] font-black tracking-[0.3em] text-slate-300 uppercase">Sort by</span>
        <div class="flex gap-6">
          <button class="border-b border-slate-900 text-[10px] font-bold tracking-widest text-slate-900 uppercase">Newest</button>
          <button class="text-[10px] font-bold tracking-widest text-slate-400 uppercase transition-colors hover:text-slate-900">Rating</button>
          <button class="text-[10px] font-bold tracking-widest text-slate-400 uppercase transition-colors hover:text-slate-900">Title</button>
        </div>
      </div>
    </header>

    <section class="grid grid-cols-1 gap-x-8 gap-y-16 sm:grid-cols-2 lg:grid-cols-3">
      {sortedBooks.map((book) => (
        <div class="group flex h-full w-full flex-col rounded-[2.5rem] bg-white px-8 pt-8 pb-8 shadow-[0_10px_40px_-15px_rgba(0,0,0,0.04)] transition-all duration-700 hover:shadow-[0_40px_80px_-20px_rgba(0,0,0,0.12)]">
          
          <div class="mb-8 flex h-52 items-center justify-center overflow-hidden">
            <img 
              src={book.data.image} 
              class="h-full object-contain drop-shadow-[0_20px_30px_rgba(0,0,0,0.12)] transition-transform duration-700 group-hover:scale-105" 
              alt={book.data.title} 
            />
          </div>

          <div class="flex flex-grow flex-col px-2 text-center">
            <h2 class="mb-4 line-clamp-2 font-serif text-[22px] leading-tight font-black text-slate-900">
              {book.data.title} by {book.data.author}
            </h2>

            <div class="mt-auto">
              <div class="mb-6 flex items-center justify-between border-t border-slate-100 pt-6">
                <div class="text-left">
                  <span class="block text-[8px] font-black tracking-widest text-slate-300 uppercase">Rating</span>
                  <span class="font-serif text-base leading-none text-slate-900 italic">{book.data.rating}</span>
                </div>
                <div class="text-right">
                  <span class="block text-[8px] font-black tracking-widest text-slate-300 uppercase">Finished</span>
                  <span class="font-serif text-base leading-none text-slate-900 italic">{book.data.finished}</span>
                </div>
              </div>

              <a href={`/library/${book.slug}`} class="inline-flex items-center justify-center gap-2 text-[12px] font-black tracking-widest text-slate-900 uppercase transition-colors group-hover:text-rose-500"> 
                Read Notes <span class="text-lg transition-transform group-hover:translate-x-1">→</span> 
              </a>
            </div>
          </div>
        </div>
      ))}
    </section>
  </main>

  <footer class="mx-auto mt-20 w-full max-w-6xl border-t border-slate-200/60 px-6 py-24 text-center md:px-10">
    <div class="mx-auto max-w-md">
      <h2 class="mb-6 font-serif text-4xl tracking-tight text-slate-900 italic">Thoughts?</h2>
      <p class="mb-12 text-[13px] leading-relaxed font-medium text-slate-400">
        Feel free to ping me if any of these notes sparked an idea.
      </p>
      <div class="flex flex-col items-center gap-2 mt-8">
        <div class="h-1 w-1 rounded-full bg-rose-400"></div>
        <p class="text-[9px] font-bold uppercase tracking-[0.5em] text-slate-200 uppercase">Bengaluru • 2026</p>
      </div>
    </div>
  </footer>
</div>
